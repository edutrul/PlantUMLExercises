@startuml

/' 
@id: COMP-002
@file: COMP-002--fusion-architecture-multisite.puml
@title: Fusion Architecture â€“ Multisite Indexing & Search
@type: component
@description: Shows how Drupal multisites (pro, edu, etc.) connect to Lucidworks Fusion using individual datasources and query pipelines with a shared indexing pipeline and central collection.
@related:
'/

<style>
  component {
    FontSize 18
    Padding 10
  }
  title {
    FontSize 18
  }
  database {
    FontSize 28
    Padding 12
    LineThickness 2
    BackgroundColor #F9F9F9
  }
</style>

title Fusion Architecture â€“ Multisite Indexing & Search

rectangle " " {
  package "Drupal Sites" {
    [pro_baxter_com_datasource] as "ğŸ“¦ pro_baxter_com_datasource" <<component>>
    [edu_baxter_com_datasource] as "ğŸ“¦ edu_baxter_com_datasource" <<component>>
    [pro_baxter_ca_datasource] as "ğŸ“¦ pro_baxter_ca_datasource" <<component>>
    [+150 additional datasources] as "ğŸ“¦ +150 additional\ndatasources" <<component>>
  }

  package "Fusion Platform" {
    package "Indexing Pipelines" {
      [shared_indexing_pipeline] as "ğŸ” shared_indexing_pipeline" <<component>>
    }

    package "Query Pipelines" {
      [pro_baxter_com_query_pipeline] as "ğŸ” pro_baxter_com_query_pipeline" <<component>>
      [edu_baxter_com_query_pipeline] as "ğŸ” edu_baxter_com_query_pipeline" <<component>>
      [pro_baxter_ca_query_pipeline] as "ğŸ” pro_baxter_ca_query_pipeline" <<component>>
      [+150 additional query pipelines] as "ğŸ” +150 additional\nquery pipelines" <<component>>
    }

    database "ğŸ—ƒï¸   COSMOS Collection   " as cosmos_collection
  }
}

' Indexing flow
[pro_baxter_com_datasource] --> [shared_indexing_pipeline]
[edu_baxter_com_datasource] --> [shared_indexing_pipeline]
[pro_baxter_ca_datasource] --> [shared_indexing_pipeline]
[+150 additional datasources] --> [shared_indexing_pipeline]

[shared_indexing_pipeline] --> cosmos_collection

' Query flow
[pro_baxter_com_query_pipeline] --> cosmos_collection
[edu_baxter_com_query_pipeline] --> cosmos_collection
[pro_baxter_ca_query_pipeline] --> cosmos_collection
[+150 additional query pipelines] --> cosmos_collection

note bottom of cosmos_collection
  ğŸ” Approx. 150 Drupal sites are connected via
  unique datasources and query pipelines.
end note

legend bottom
|= Symbol |= Meaning |
| ğŸ“¦       | Drupal-specific datasource |
| ğŸ”       | Site-specific query pipeline |
| ğŸ”       | Shared indexing pipeline |
| ğŸ—ƒï¸       | Shared Fusion Collection |
endlegend

@enduml